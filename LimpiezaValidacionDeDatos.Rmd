---
title: "Práctica 2: Limpieza y validación de los datos"
author: "Byron Vinicio Lima Rojas"
date: '`r format(Sys.Date(),"%e de %B, %Y")`'
output:
  pdf_document:
    toc: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_libraries, include=FALSE}
library(knitr)
library(nortest)
```

#Práctica 2

El objetivo de esta actividad será el tratamiento de un dataset, que puede ser el creado en la práctica 1 o cualquier dataset libre disponible en Kaggle (https://www.kaggle.com). 

Para esta práctica utilizaremos un dataset de Kaggle que contiene información de los 16.598 videojuegos con una fecha de inicio del año 1980, así como sus datos de ventas en un total de 11 variables.


```{r,eval=TRUE,echo=TRUE}
videogames<-read.csv("vgsales.csv", sep=",",na.strings = "NA", dec = ".")

```
Las variables son:

* **Rank** - Ranking de las ventas totales.
* **Name** - El nombre de los juegos.
* **Platform** - Plataforma de lanzamiento de juegos
* **Year** - Año del lanzamiento
* **Genre** - Género
* **Publisher** - Editor
* **NA_Sales** - Ventas en América del Norte (millones)
* **EU_Sales** - Ventas en Europa (millones)
* **JP_Sales** - Ventas en Japón (millones)
* **Other_Sales** - Ventas en el resto del mundo (millones)
* **Global_Sales** - Total de ventas en todo el mundo.

# 1. Descripción del Dataset

La industria de los videojuegos siempre ha sido rentable, siendo una de las principales industrias del arte y entretenimiento ya que constantemente la mayoría de productoras de películas y generadoras de contenido multimedia están buscando posesionarse en lo más alto en el mercado actual, cuando un producto inicial es atractivo al público buscan crear nuevo contenido a partir del mismo (series, revistas, videojuegos).

Sin embargo, dar con la idea de qué tipo de videojuego crear y a que empresa encomendar dicha tarea no es fácil, es por cuanto el Dataset que va a ser analizado contiene datos de videojuegos desde el año 1980, en donde se revisaran los editores con más éxito en la venta de videojuegos y nos permitirá conocer qué tipo de videojuego es más rentable, de esta forma podremos brindar recomendaciones a nuevas compañías en cuando a que contenido crear, tipo de historia, la clasificación que debe tener el videojuego y a que plataforma enfocarse para ser un producto exitoso.


```{r,eval=TRUE,echo=TRUE}
# CORRECCIÓN DE SEPARADORES DECIMALES
# Cuando se grabe como .csv2 quedará como , decimal.
videogames$NA_Sales <-  as.numeric(sub(",","\\.",videogames$NA_Sales))
videogames$EU_Sales <-  as.numeric(sub(",","\\.",videogames$EU_Sales))
videogames$JP_Sales <-  as.numeric(sub(",","\\.",videogames$JP_Sales))
videogames$Other_Sales <-  as.numeric(sub(",","\\.",videogames$Other_Sales))
videogames$Global_Sales <-  as.numeric(sub(",","\\.",videogames$Global_Sales))
# Descripción de variables contenidas en el Dataset.
str(videogames)
```

# 2. Limpieza de los datos.

## 2.1. Selección de los datos de interés a analizar. ¿Cuáles son los campos más relevantes para responder al problema?

De acuerdo al objetivo inicial del uso de estos datos, los campos más relevantes para realizar una propuesta son los siguientes:

* **Rank** - Ranking de las ventas totales.
* **Name** - El nombre de los juegos.
* **Platform** - Plataforma de lanzamiento de juegos
* **Year** - Año del lanzamiento
* **Genre** - Género
* **Publisher** - Editor
* **Global_Sales** - Total de ventas en todo el mundo.

De estos datos es importante analizarlos por separado, de acuerdo al ranking de ventas, año de publicación género y ventas globales. Estos datos serán analizados por separados para realizar propuestas significativas.

## 2.2. ¿Los datos contienen ceros o elementos vacíos? ¿Y valores extremos? ¿Cómo gestionarías cada uno de estos casos?

De las variables seleccionadas, procederemos a revisar los datos que contiene cada una:
```{r,eval=TRUE,echo=TRUE}
table(videogames$Platform)
table(videogames$Year)
table(videogames$Genre)
```
De los datos del editor se revisaron manualmente por la cantidad de datos y no existen datos que contienen ceros o elementos vacíos.

De acuerdo a lo revisado, en años ya hay un valor atípico con el dato en año 2020 y hay videojuegos que no tienen fecha de publicación, para este caso podemos imputar los valores a partir de los k-vecinos más próximos o eliminarlos. Al ser únicamente 278 registros con este inconveniente no los tomaremos en cuenta.

```{r,eval=TRUE,echo=TRUE}
#Revisión de datos en Ventas
summary(videogames$Global_Sales)
```

Claramente entre el cuarto y quinto quartil hay mucha diferencia, puesto que existen datos muy antiguos para ser analizados, los cuales al momento con los distintos cambios en la tecnología no sería prudente tomarlos en cuenta, adicional podría ser que en el análisis recomendemos un juego que fue diseñado para una plataforma no disponible en el mercado. En base a estas observaciones utilizaremos únicamente los videojuegos de los últimos 10 años (2007 - 2017) y de plataformas existentes. 


```{r,eval=TRUE,echo=TRUE}
#Creación de un nuevo Dataset a partir del año.
vgamesP <- subset(videogames, videogames$Year == "2007" 
                        | videogames$Year == "2008" | videogames$Year == "2009" 
                        | videogames$Year == "2010" | videogames$Year == "2011" 
                        | videogames$Year == "2012" | videogames$Year == "2013" 
                        | videogames$Year == "2014" | videogames$Year == "2015" 
                        | videogames$Year == "2016" | videogames$Year == "2017", 
                        select = c(Rank, Name, Platform, Year, Genre, Publisher,
                                   Global_Sales))


#Creación de Dataset Final a partir
videogamesnew <- subset(vgamesP, vgamesP$Platform == "3DS" 
                        | vgamesP$Platform == "DS" | vgamesP$Platform == "PC"
                        | vgamesP$Platform == "PS2" | vgamesP$Platform == "PS3"
                        | vgamesP$Platform == "PS4" | vgamesP$Platform == "PSP"
                        | vgamesP$Platform == "PSV" | vgamesP$Platform == "Wii"
                        | vgamesP$Platform == "X360" | vgamesP$Platform == "XOne")

#Detalle de datos
head(videogamesnew)
#Número de Registros
nrow(videogamesnew)
#Número de columnas
ncol(videogamesnew)
```

# 3. Análisis de los datos.

## 3.1. Selección de los grupos de datos que se quieren analizar/comparar.

Después de realizar la limpieza de datos es importante detallar los procedimientos realizados para lograr un conjunto de datos limpio y adaptable a las conclusiones que queremos llegar:

* Exclusión de valores atípicos en los años del conjunto.
* Exclusión de registros con valores perdidos o campos vacíos puesto que los mismos no representaban un gran número de datos que impidan realizar el análisis de datos.
* Exclusión de registros de acuerdo a su monto de ventas, se realizó mediante la revisión de las distancias entre los cuartiles presentes en los valores de venta globales por cada uno de los registros, de esta forma todo videojuego con ventas globales menores a 0.75 millones / dólares no será tomado en cuenta. 

Como uno de los propósitos es realizar una recomendación hacia la nueva industria sobre qué características debe tener un juego para ser exitoso, vamos a realizar una comparativa entre las siguientes variables existentes en el conjunto de datos:

* **Genre / Global_Sales: ** Análisis del número de ventas en base al género
* **Platform / Global_Sales: ** Análisis del número de ventas en base a la plataforma del videojuego.
* **Publisher / Global_Sales: ** Análisis del número de ventas de cada uno de los editores.
* **Rank / Genre: ** Análisis del género en base al ranking del Top 50 de videojuegos.
* **Rank / Platform: ** Análisis de la plataforma en base al ranking del Top 50 de videojuegos.

A partir del análisis de estas variables, se podrá llegar a las conclusiones necesarias recomendar puntos importantes que se deben tomar en cuenta antes de crear un videojuego.

## 3.2. Comprobación de la normalidad y homogeneidad de la varianza. Si es necesario (y posible), aplicar transformaciones que normalicen los datos.

Al tener un solo dato numérico en la selección de datos a analizar, vamos a revisar determinadas características:

```{r,eval=TRUE,echo=TRUE}
summary(videogamesnew$Global_Sales)
```
En base a los datos, del 3er Quartil (0,4300 millones) y el valor máximo (35.82 millones). Procedemos a reducir el número de registros en base a videojuegos que han realizado ventas mayores a 0.75 millones de copias.

```{r,eval=TRUE,echo=TRUE}
videogamesnewS <- subset(videogamesnew, videogamesnew$Global_Sales > 0.75)
nrow(videogamesnewS)
```

Después de este filtro nos hemos quedado con 1334 registros en el Dataset **videogamesnewS**. A partir de los mismos, empezaremos a realizar las pruebas necesarias para llegar a una recomendación idónea. En base a este filtro, se puede ver que existen valores atípicos dentro de las ventas globales, pero eso únicamente determina el éxito en ventas del videojuego lo cual analizaremos en el siguiente enunciado mediante grupo de datos.

A continuación, se procede con la graficación de las tres variables más importantes en relación a su monto de ventas a nivel mundial:

**Validación de variables normales con Shapiro**

```{r,eval=TRUE,echo=TRUE}
#Ventas globales
media <- mean(videogamesnewS$Global_Sales)
desviacionestandar <- sd(videogamesnewS$Global_Sales)
shapiro.test(videogamesnewS$Global_Sales)
```

**Interpretación: ** siendo la hipótesis nula que las ventas están distribuidas normalmente, en este caso p-valor es menor a alfa, entonces esta hipótesis nula es rechazada, concluyendo de esta forma que los datos de ventas globales no provienen de una distribución normal.

## 3.3. Aplicación de pruebas estadísticas (tantas como sea posible) para comparar los grupos de datos.

Antes de empezar las pruebas estadisticas, es importante conocer por separado que datos tenemos en cada grupo de datos

```{r,eval=TRUE,echo=TRUE}
#Plataforma de videojuegos
table(videogamesnewS$Platform)
#Género
table(videogamesnewS$Genre)
#Año de venta
table(videogamesnewS$Year)
```

Después de la revisión de datos individuales se puede evidenciar que hay plataformas de videojuego que ya no son utilizadas, adicional solo estamos utilizando datos a partir del 2008, de acuerdo a los géneros no existe inconsistencia en valores de variables. Para lo cual procedemos a realizar una tabla de los datos relevantes de nuestro subconjunto de datos:

```{r,eval=TRUE,echo=TRUE}
library(knitr)
options(knitr.kable.NA = '')

#Revisión de datos del data set VideoGamesNewS.
kable(summary(videogamesnewS)[,c(3,4,5,6)],
      digits=2, caption="Estadística descriptiva de variables")

#Revisión del género y nombres de videojuegos del total de datos.
vgamesP <- subset(videogames, videogames$Year != "2020" 
                        | videogames$Year == "NA", 
                        select = c(Rank, Name, Platform, Year, Genre, Publisher,
                                   Global_Sales))
kable(summary(vgamesP)[,c(2,5)],
      digits=2)
```

El objetivo de revisar los nombres de los videojuegos más vendidos y los géneros en sí, es para determinar qué tan alejados estamos de los datos que proponemos en nuestro subconjunto, hay que tomar en cuenta que las plataformas van evolucionando, pero los géneros de videojuegos y la forma de jugarlos permanecen.

Bueno, ya tenemos datos de las plataformas, géneros y editores con mayor número de publicaciones, es necesario conocer la cantidad de copias que consiguieron vender, para fundamentar nuestros resultados finales, para ello procederemos con la creación de suconjuntos.

**Ventas globales por plataforma**

```{r,eval=TRUE,echo=TRUE}
#Plataforma PS3
PS301 <- subset(videogamesnewS, videogamesnewS$Platform == "PS3")
PS3 <- sum (PS301$Global_Sales)
PS3
#Plataforma X360
X36001 <- subset(videogamesnewS, videogamesnewS$Platform == "X360")
X360 <- sum (X36001$Global_Sales)
X360
#Plataforma Wii
Wii01 <- subset(videogamesnewS, videogamesnewS$Platform == "Wii")
Wii <- sum (Wii01$Global_Sales)
Wii
#Plataforma DS
DS01 <- subset(videogamesnewS, videogamesnewS$Platform == "DS")
DS <- sum (DS01$Global_Sales)
DS
#Plataforma PS4
PS401 <- subset(videogamesnewS, videogamesnewS$Platform == "PS4")
PS4 <- sum (PS401$Global_Sales)
PS4
#Plataforma 3DS
EDS01 <- subset(videogamesnewS, videogamesnewS$Platform == "3DS")
EDS <- sum (EDS01$Global_Sales)
EDS
#Plataforma PC
PC01 <- subset(videogamesnewS, videogamesnewS$Platform == "PC")
PC <- sum (PC01$Global_Sales)
PC
#Plataforma PS2
PS201 <- subset(videogamesnewS, videogamesnewS$Platform == "PS2")
PS2 <- sum (PS201$Global_Sales)
PS2
#Plataforma XOne
XOne01 <- subset(videogamesnewS, videogamesnewS$Platform == "XOne")
XOne <- sum (XOne01$Global_Sales)
XOne
#Análisis de 5-números de 5 plataformas de videojuegos más vendidos
summary (c(PS3,X360,Wii,DS,PS4))
```


**Conclusión: ** De los 1334 registros de nuestro subconjunto estamos revisando únicamente las plataformas con mejores ventas, a esto hay que considerar que un videojuego está disponible para varias versiones, lo cual sustentaremos en base a la revisión por género de venta. De los valores de ventas, están cerca del valor máximo del total de datos. Para la revisión del género, analizaremos datos desde el 2008 realizando una comparativa de 5 números a partir de los 5 mejores géneros.


**Ventas globales por Género**


```{r,eval=TRUE,echo=TRUE}
#Género Action
Action01 <- subset(videogamesnewS, videogamesnewS$Genre == "Action")
Action <- sum (Action01$Global_Sales)
Action
#Género Sports
Sports01 <- subset(videogamesnewS, videogamesnewS$Genre == "Sports")
Sports <- sum (Sports01$Global_Sales)
Sports
#Género Shooter
Shooter01 <- subset(videogamesnewS, videogamesnewS$Genre == "Shooter")
Shooter <- sum (Shooter01$Global_Sales)
Shooter
#Género Role-Playing
RolePlaying01 <- subset(videogamesnewS, videogamesnewS$Genre == "Role-Playing")
RolePlaying <- sum (RolePlaying01$Global_Sales)
RolePlaying
#Género Misc
Misc01 <- subset(videogamesnewS, videogamesnewS$Genre == "Misc")
Misc <- sum (Misc01$Global_Sales)
Misc
#Género Racing
Racing01 <- subset(videogamesnewS, videogamesnewS$Genre == "Racing")
Racing <- sum (Racing01$Global_Sales)
Racing
#Género Fighting
Fighting01 <- subset(videogamesnewS, videogamesnewS$Genre == "Fighting")
Fighting <- sum (Fighting01$Global_Sales)
Fighting
#Género Platform
Platform01 <- subset(videogamesnewS, videogamesnewS$Genre == "Platform")
Platform <- sum (Platform01$Global_Sales)
Platform
#Género Puzzle
Puzzle01 <- subset(videogamesnewS, videogamesnewS$Genre == "Puzzle")
Puzzle <- sum (Puzzle01$Global_Sales)
Puzzle
#Género Simulation
Simulation01 <- subset(videogamesnewS, videogamesnewS$Genre == "Simulation")
Simulation <- sum (Simulation01$Global_Sales)
Simulation
#Género Strategy
Strategy01 <- subset(videogamesnewS, videogamesnewS$Genre == "Strategy")
Strategy <- sum (Strategy01$Global_Sales)
Strategy
#Género Adventure
Adventure01 <- subset(videogamesnewS, videogamesnewS$Genre == "Adventure")
Adventure <- sum (Adventure01$Global_Sales)
Adventure
#Análisis de los 5 géneros de videojuegos más vendidos
summary (c(Action,Sports,Shooter,RolePlaying,Misc))
```

A continuación, vamos a revisar las ventas globales de acuerdo al editor de videojuego:

**Ventas globales por Editor**

```{r,eval=TRUE,echo=TRUE}
#Editor Electronic Arts
ElectronicArts01 <- subset(videogamesnewS, videogamesnewS$Publisher == "Electronic Arts")
ElectronicArts <- sum (ElectronicArts01$Global_Sales)
ElectronicArts
#Editor Nintendo
Nintendo01 <- subset(videogamesnewS, videogamesnewS$Publisher == "Nintendo")
Nintendo <- sum (Nintendo01$Global_Sales)
Nintendo
#Editor Ubisoft
Ubisoft01 <- subset(videogamesnewS, videogamesnewS$Publisher == "Ubisoft")
Ubisoft <- sum (Ubisoft01$Global_Sales)
Ubisoft
#Editor Activision
Activision01 <- subset(videogamesnewS, videogamesnewS$Publisher == "Activision")
Activision <- sum (Activision01$Global_Sales)
Activision
#Editor Take-Two Interactive
TakeTwoInteractive01 <- subset(videogamesnewS, 
                               videogamesnewS$Publisher == "Take-Two Interactive")
TakeTwoInteractive <- sum (TakeTwoInteractive01$Global_Sales)
TakeTwoInteractive
#Editor Sony Computer Entertainment
SonyComputer01 <- subset(videogamesnewS, 
                         videogamesnewS$Publisher == "Sony Computer Entertainment")
SonyComputer <- sum (SonyComputer01$Global_Sales)
SonyComputer
#Editor THQ
THQ01 <- subset(videogamesnewS, videogamesnewS$Publisher == "THQ")
THQ <- sum (THQ01$Global_Sales)
THQ
#Editor Sega
Sega01 <- subset(videogamesnewS, videogamesnewS$Publisher == "Sega")
Sega <- sum (Sega01$Global_Sales)
Sega
#Editor Warner Bros
WarnerBros01 <- subset(videogamesnewS, 
                       videogamesnewS$Publisher == "Warner Bros. Interactive Entertainment")
WarnerBros <- sum (WarnerBros01$Global_Sales)
WarnerBros
#Análisis de los 5 editores con más videojuegos más vendidos
summary (c(ElectronicArts,Nintendo,Ubisoft,Activision,TakeTwoInteractive))
```

En base a los datos observadores, se puede determinar que hay una empresa editora de videojuegos que lidera en los últimos 10 años, y las ventas de las otras 4 empresas considerablemente no se encuentran alejadas de la media de ventas.

**Validación del género de los videojuegos del Top 50 de nuestro subconjunto de datos**

```{r,eval=TRUE,echo=TRUE}
videogamesrank<- subset(videogamesnewS, videogamesnewS$Rank < 51)
table(videogamesrank$Genre)
```

**Validación de la plataforma de los videojuegos del Top 50 de nuestro subconjunto de datos**

```{r,eval=TRUE,echo=TRUE}
table(videogamesrank$Platform)
```

Adicional, vamos a realizar la prueba de Kruskal-Wallis de los valores globales con el resto de variables significativas:

```{r,eval=TRUE,echo=TRUE}
#Género
kruskal.test (Genre ~ Global_Sales, data = videogames) 
#Editor
kruskal.test (Publisher ~ Global_Sales, data = videogames) 
#Plataforma
kruskal.test (Platform ~ Global_Sales, data = videogames) 
```

De acuerdo a los datos obtenidos, podemos deducir que al ser todos los p-valores > 0.05 se puede decir que los grupos son estadísticamente casi iguales, es decir no existen diferencias significativas entre las ventas globales y el resto de variables que estamos analizando del conjunto de datos.

# 4. Representación de los resultados a partir de tablas y gráficas.

A continuación, se presentarán los resultados obtenidos del análisis realizado a los registros de nuestro dataset limpio.

**Plataforma de VideoJuegos**
```{r,eval=TRUE,echo=TRUE}
PlatformVideoGames <- cbind(PS3,X360,Wii,DS,PS4, EDS, XOne, PC, PS2)
colnames(PlatformVideoGames) <- c("PS3","X360","Wii","DS","PS4","3DS","XOne","PC","PS2")
kable(PlatformVideoGames)
```

**Género de VideoJuegos**
```{r,eval=TRUE,echo=TRUE}
GenreVideoGames <- cbind(Action,Sports,Shooter,RolePlaying,Misc,Racing,Simulation,Fighting,
                         Platform,Puzzle)
colnames(GenreVideoGames) <- c("Action","Sports","Shooter","RolePlaying","Misc",
                            "Racing","Simulation","Fighting","Platform","Puzzle")
kable(GenreVideoGames)
```

**Editor de VideoJuegos**
```{r,eval=TRUE,echo=TRUE}
PublisherVideoGames <- cbind(ElectronicArts,Nintendo,Activision,Ubisoft,TakeTwoInteractive,
                         SonyComputer,WarnerBros,Sega)
colnames(PublisherVideoGames) <- c("ElectronicArts","Nintendo",
                              "Activision","Ubisoft","Take2Interactive","SonyComputer",
                              "WarnerBros","Sega")
kable(PublisherVideoGames)
```

A continuación procedemos con la gráficación de las tres variables más influyentes del conjunto de datos en relación con las ventas globales.

**Análisis de datos mediante gráficas**

```{r,eval=TRUE,echo=TRUE}
#Detalle de ventas por género de cada videojuego
plot(videogamesnewS$Genre, videogamesnewS$Global_Sales, col="blue", 
     main = 'Diagrama de análisis de videojuegos por Género',
     ylab="Ventas por millones", xlab="Clasificación por género",cex.axis=0.4,cex=0.4)
#Detalle global de ventas por cada género de videojuego
barplot(GenreVideoGames,cex.axis=0.4,cex=0.4)
```

**Conclusión:** De acuerdo a la revisión de valores por género se puede decir que existen valores atípicos, pero al tratarse de ventas por unidad de videojuego única en el conjunto de datos se puede deducir aquellos géneros en videojuegos que triunfaron en el mercado, pero más allá no puede determinar el éxito absoluto de dicha categoría puesto que puede ser un "golpe de suerte" en la acogida que tuvo con el público. Entre los géneros que se observan que han tenido más perseverancia en el mercado son de acción, plataformas, disparos y deportes.

```{r,eval=TRUE,echo=TRUE}
#Detalle de ventas por plataformas en videojuegos
plot(videogamesnewS$Platform, videogamesnewS$Global_Sales, col="blue", 
     main = 'Ventas de videojuegos por Plataforma',
     ylab="Ventas por millones", xlab="Clasificación por Plataforma",cex.axis=0.4,cex=0.4)
#Detalle global de ventas por plataforma
barplot(PlatformVideoGames,cex.axis=0.4,cex=0.4)
```

**Conclusión:** Al tratarse de plataformas de videojuegos, se conoce la evolución de las mismas y solo aquellas que innovan en su formato de presentación y adaptación de videojuegos para dicho tipo de consola sobreviven, en base a la gráfica se puede observar que existen plataformas con ventas bajas que se pueden considerar en la actualidad como obsoletas. Se puede evidenciar el éxito de determinadas plataformas entre ellas las versiones de Play Station y las versiones de Xbox, adicional se observa el éxito que tuvo la consola de Wii en su momento.

```{r,eval=TRUE,echo=TRUE}
#Detalle global de Ventas por Editor
barplot(PublisherVideoGames, cex.axis=0.4,cex=0.4,main = 'Ventas de videojuegos por Editor')
```

**Conclusión:** De acuerdo a la revisión de ventas de editores, se evidencia aquellos con mayor éxito en el mercado, puede concluir que son aquellos que se mantienen vigentes de acuerdo al número de lanzamientos de videojuegos, lo que hay que considerar el número total de ventas puesto que pueden tener un par de juegos y figurarse entre los mejores.

De acuerdo a los datos graficados, se analizarán en conjuntos con los datos obtenidos de la revisión de los subconjuntos de datos por tipos que se reflejan en las tablas con la finalidad de fundamentar los resultados obtenidos y las propuestas realizadas.

**Análisis por Plataforma y Género**

Una vez analizados cada uno de los editores, géneros y plataformas por separado es necesario tener en cuenta que por cada plataforma existe una forma única de jugar, por lo cual es importante segmentar datos por grupos de plataformas similares para de esta forma, analizar sus ventas y géneros. En base a lo mencionado, se procede con la segmentación de tres grupos de datos:

* **Grupo 1:** PC, PS2, PS3, PS4, X360 Y XOne

```{r,eval=TRUE,echo=TRUE}
Grupo01 <- subset(videogamesnewS, videogamesnewS$Platform == "PC" |
                    videogamesnewS$Platform == "PS2" | videogamesnewS$Platform == "PS3" |
                    videogamesnewS$Platform == "PS4" | videogamesnewS$Platform == "X360" |
                    videogamesnewS$Platform == "XOne")
table(Grupo01$Genre)
```

* **Grupo 2:** Wii

```{r,eval=TRUE,echo=TRUE}
Grupo02 <- subset(videogamesnewS, videogamesnewS$Platform == "Wii")
table(Grupo02$Genre)
```

* **Grupo 3:** DS y 3DS

```{r,eval=TRUE,echo=TRUE}
Grupo03 <- subset(videogamesnewS, videogamesnewS$Platform == "DS" |
                    videogamesnewS$Platform == "3DS")
table(Grupo03$Genre)
#Revisión de ventas significativas a partir de grupos de datos segmentados en plataformas
wilcox.test(Grupo01$Global_Sales,Grupo02$Global_Sales,paired=FALSE,conf.level=0.90)
wilcox.test(Grupo01$Global_Sales,Grupo03$Global_Sales,paired=FALSE,conf.level=0.90)
wilcox.test(Grupo02$Global_Sales,Grupo03$Global_Sales,paired=FALSE,conf.level=0.90)
```

De acuerdo a los resultados de ventas analizados por grupos en plataformas, entre el grupo 1 y Grupo 2 no existe mucha diferencia en cuanto al p-value, mientras que en la comparativa del grupo 1 y grupo 3 existe un valor-p elevado. En estas tres comparativas se evidencia que no cumple una hipótesis nula, lo que nos lleva a un resultado segmentado por plataforma.

# 5. Resolución del problema. A partir de los resultados obtenidos, ¿cuáles son las conclusiones? ¿Los resultados permiten responder al problema?

Con los datos obtenidos, es más fácil responder a una inquietud de una empresa en cuanto a la necesidad de crear un nuevo videojuego para posesionarse como una marca competente dentro del mercado actual.

En la limpieza de datos excluimos aquellos juegos con menos ganancias y aquellos videojuegos menores del año 2007 puesto que, 10 años después la forma de jugar ha cambiado y muchas de las consolas de videojuegos ya no se encuentran disponibles en el mercado. Además, los videojuegos se ven censurados de acuerdo a su clasificación de videojuegos puesto que actualmente están enfocados para ser utilizado por el público de todas las edades y el contenido debe ser restringido. 

Bien, volviendo a nuestro propósito inicial hemos analizados cada uno de los datos de nuestro Conjunto de Datos, en donde llegamos a las siguientes conclusiones:

* **GÉNERO: ** De acuerdo a los datos analizados en nuestro dataset, al final solo quedaron 12 categorías como las más demandadas en los últimos 10 años. De las cuales los más demandados figuran los géneros de acción, deportes, disparos (subcategoría de acción), Juego de roles y Misceláneas. 

En la revisión de plataformas se identificó cambios en género de acuerdo al tipo de consola que se desea desarrollar, para lo cual se dividió las plataformas más demandadas en 3 grupos, esto de acuerdo al método de juegos y los accesorios que se disponen para manejar la plataforma que brindaN mejor experiencia al usuario, en donde se procede a recomendar lo siguiente:

* **Grupo 1 (PC, PS2, PS3, PS4, X360 Y XOne): ** Acción, juegos de roles, carreras y peleas.
* **Grupo 2 (Wii): ** Deportes, acción y estrategia.
* **Grupo 3 (DS y 3DS): ** Acción, juego de roles y simulación.

Estos valores se encuentran fundamentados en ventas y aceptación de los usuarios. Hay que tener en cuenta, que para el desarrollo de cada grupo, existe la posibilidad de migrar las versiones a una nueva plafatorma disminuyendo así costos de desarrollo.

* **PLATAFORMA: ** Para determinar a qué plataformas debemos enfocar el videojuego, se consideró un tiempo de 10 años que toma en dejar de comercializarse una consola, este también depende del nivel de acogida que tuvo por las personas, para lo cual al momento las plataformas más rentables son PS3, XBOX 360, y Wii. A pesar que, juegos para PS4 y XOne no son tan relevantes como las primeras es importante tomar en cuenta que son las sucesoras de las primeras consolas, y deben tomarse en cuenta para evitar un doble trabajo a futuro. Para desarrollar en plataformas DS y 3DS sería más recomendable de lanzar una versión móvil del juego. En este caso PC y PS2 ya no son tomadas en cuenta, puesto que un PC debe ser de buenas características para que se ejecute con normalidad un juego y PS2 ya salió del mercado. En base al número de ventas podría considerarse o no desarrollar para estas plataformas.

* **EDITOR: ** En la parte del editor del videojuego, ese que será el encargado de plasmar nuestra idea en gráficos y código, la calidad del mismo dependerá mucho del capital que la empresa decida invertir. Para esto, una recomendación es trabajar en conjunto con Electronic Arts, Nintento, Activision y ubisoft. Adicional también estan Take Two interactive, Sony Computer, Warner Bros y Sega. Para fundamentarse en quien contratar la empresa puede basarse en los numeros de ventas de estas empresas.


# **Exportación de datos limpios**
```{r,eval=TRUE,echo=TRUE}
write.csv2(videogamesnewS$Platform , file="vgsales_clean.csv", row.names = FALSE)
```


